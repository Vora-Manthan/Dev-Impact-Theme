{%- render 'section-spacing-collapsing' -%}

<style>
  #shopify-section-{{ section.id }} {
    --faq-bg-color: {{ section.settings.background | default: '#AAE1EA' }};
    background-color: var(--faq-bg-color);
    position: relative;
    overflow: hidden;
  }

  .faq-custom-container {
    padding: 100px 20px 80px; /* Increased padding to clear waves */
    max-width: 900px;
    margin: 0 auto;
    position: relative;
    z-index: 2;
  }

  .faq-header {
    text-align: center;
    margin-bottom: 40px;
  }

  .faq-header h2 {
    font-size: 36px;
    font-weight: 700;
    margin-bottom: 10px;
    color: {{ section.settings.heading_color | default: '#1a1a1a' }};
  }

  .faq-header p.subheading {
    text-transform: uppercase;
    font-size: 14px;
    letter-spacing: 1px;
    color: {{ section.settings.text_color | default: '#4a4a4a' }};
    font-weight: 500;
  }
  
  /* Wave Styles */
  .faq-wave {
    position: absolute;
    left: 0;
    width: 100%;
    line-height: 0;
    direction: ltr;
    z-index: 1;
    pointer-events: none;
  }
  
  .faq-wave svg {
    display: block;
    width: 100%;
    height: auto;
    max-height: 60px; /* Adjust height as needed */
  }
  
  .faq-wave--top {
    top: -1px; /* Overlap slightly to prevent gaps */
    transform: rotate(0deg);
  }
  
  .faq-wave--bottom {
    bottom: -1px;
    transform: rotate(180deg);
  }

  @media screen and (max-width: 768px) {
    .faq-custom-container {
      padding: 60px 15px 50px;
    }
    .faq-header h2 {
      font-size: 28px;
    }
    .faq-wave svg {
        max-height: 30px;
    }
  }
</style>

<div {% render 'section-properties' %}>
  {%- if section.settings.show_waves -%}
    <div class="faq-wave faq-wave--top">
      <svg viewBox="0 0 1200 120" preserveAspectRatio="none">
        <path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" fill="{{ section.settings.wave_color }}"></path>
      </svg>
    </div>
  {%- endif -%}

  <div class="faq-custom-container">
    
    <div class="faq-header">
      {%- if section.settings.title != blank -%}
        <h2 class="h2">
          {{ section.settings.title | escape }}
        </h2>
      {%- endif -%}
      {%- if section.settings.subheading != blank -%}
        <p class="subheading">{{ section.settings.subheading | escape }}</p>
      {%- endif -%}
    </div>

    {%- if section.blocks.size > 0 -%}
      <div class="faq-list">
        {%- for block in section.blocks -%}
          {%- if block.settings.title != blank and block.settings.content != blank -%}
            {%- capture accordion_content -%}
              <div class="prose">{{ block.settings.content }}</div>
            {%- endcapture -%}
            
            {%- render 'accordion-faq', title: block.settings.title, content: accordion_content, open: false -%}
          {%- endif -%}
        {%- endfor -%}
      </div>
    {%- endif -%}

    {%- if section.settings.footer_text != blank -%}
      <div style="text-align: center; margin-top: 30px; font-size: 14px;">
        {{ section.settings.footer_text }}
      </div>
    {%- endif -%}

  </div>

  {%- if section.settings.show_waves -%}
    <div class="faq-wave faq-wave--bottom">
      <svg viewBox="0 0 1200 120" preserveAspectRatio="none">
        <path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" fill="{{ section.settings.wave_color }}"></path>
      </svg>
    </div>
  {%- endif -%}
</div>

<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {%- for block in section.blocks -%}
        {
          "@type": "Question",
          "name": {{ block.settings.title | json }},
          "acceptedAnswer": {
            "@type": "Answer",
            "text": {{ block.settings.content | json }}
          }
        }{% unless forloop.last %},{% endunless %}
      {%- endfor -%}
    ]
  }
</script>

{% schema %}
{
  "name": "FAQ",
  "class": "shopify-section--faq",
  "tag": "section",
  "disabled_on": {
    "groups": ["header", "custom.overlay"]
  },
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Heading",
      "default": "Questions You May Have"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "WE'VE TRIED TO ANSWER THEM ALL"
    },
    {
      "type": "color",
      "id": "background",
      "label": "Section Background",
      "default": "#AAE1EA"
    },
    {
      "type": "header",
      "content": "Wave Separation"
    },
    {
      "type": "checkbox",
      "id": "show_waves",
      "label": "Show Top/Bottom Waves",
      "default": true
    },
    {
      "type": "color",
      "id": "wave_color",
      "label": "Wave Color (Page Background)",
      "default": "#fffdf7",
      "info": "Set this to the background color of the adjacent sections (usually white or off-white) to create the cutoff effect."
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#1a1a1a"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Subheading/Text Color",
      "default": "#4a4a4a"
    },
    {
        "type": "richtext",
        "id": "footer_text",
        "label": "Footer Text (Optional)"
    }
  ],
  "blocks": [
    {
      "name": "Item",
      "type": "item",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Question",
          "default": "Question"
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "Answer",
          "default": "<p>Write content to answer to common questions your customers may have about your products.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ",
      "blocks": [
        {
          "type": "item",
          "settings": {
            "title": "Will the painting/color on the bento last?",
            "content": "<p>Yes, the printing has been made to last if handled with care.</p>"
          }
        },
        {
          "type": "item",
          "settings": {
             "title": "Microwave-safe?",
             "content": "<p>Detailed answer about microwave safety.</p>"
          }
        },
        {
          "type": "item",
           "settings": {
             "title": "Is the Basil bento box safe to use?",
             "content": "<p>Yes, absolutely safe.</p>"
          }
        }
      ]
    }
  ]
}
{% endschema %}
